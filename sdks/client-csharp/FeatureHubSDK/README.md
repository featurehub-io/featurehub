# FeatureHubSDK

This library is the client SDK for the [https://featurehub.io](FeatureHub) open source project,
which brings you Cloud Native Feature Flag management, A/B experiments and remote configuration. 

This package includes the client SDK for event source, which gives you realtime updates, the
core repository, and the API required for allowing you to change the state of features using
your Service Account URL. 

The repository is isolated from the EventSource mechanism, so you can alternatively fill it
from a file or a database if you wish - and it is likely what you would do in integration tests.

## SDK features 
Details about what general features are available in SDKs from FeatureHub are [available here](https://docs.featurehub.io/#sdks).

## Using the EventSource SDK

There is a sample application included in the [solution as a console application](https://github.com/featurehub-io/featurehub/tree/master/sdks/client-csharp/ConsoleApp1).
You could implement it in the following way:

```c#
var fh = new FeatureHubRepository(); // create a new repository

// listen for changes to the feature FLUTTER_COLOUR and let me know what they are
fh.FeatureState("FLUTTER_COLOUR").FeatureUpdateHandler += (object sender, IFeatureStateHolder holder) =>
{
  Console.WriteLine($"Received type {holder.Key}: {holder.StringValue}");        
};

// you can also query the fh.FeatureState("FLUTTER_COLOUR") directly to see what its current state is
// and use it in IF statements or their equivalent

// tell me when the features have appeared and we are ready to start
fh.ReadynessHandler += (sender, readyness) =>
{
  Console.WriteLine($"Readyness is {readyness}");
};

// tell me when any new features or changes come in
fh.NewFeatureHandler += (sender, repository) =>
{
  Console.WriteLine($"New features");
};

// create an event service listener and give it the Service Account URL from the Admin-UI
var esl = new EventServiceListener();
esl.Init("http://192.168.86.49:8553/features/default/ce6b5f90-2a8a-4b29-b10f-7f1c98d878fe/VNftuX5LV6PoazPZsEEIBujM4OBqA1Iv9f9cBGho2LJylvxXMXKGxwD14xt2d7Ma3GHTsdsSO8DTvAYF", fh);

// it will now keep listening and updating the repository when changes come in. The server will kick it
// off periodically to ensure the connection does not become stale, but it will automatically reconnect
// and update itself and the repository again
``` 

## IO.FeatureHub.SSE - the C# library for the FeatureServiceApi

This describes the API clients use for accessing features

This C# SDK is automatically generated by the [OpenAPI Generator](https://openapi-generator.tech) project:

- API version: 1.1.1
- SDK version: 1.0.0
- Build package: org.openapitools.codegen.languages.CSharpNetCoreClientCodegen

## Frameworks supported
- .NET Standard 2.0+

## Dependencies

- [RestSharp](https://www.nuget.org/packages/RestSharp) - 106.10.1 or later
- [Json.NET](https://www.nuget.org/packages/Newtonsoft.Json/) - 12.0.1 or later
- [JsonSubTypes](https://www.nuget.org/packages/JsonSubTypes/) - 1.5.2 or later

The DLLs included in the package may not be the latest version. We recommend using [NuGet](https://docs.nuget.org/consume/installing-nuget) to obtain the latest version of the packages:
```
Install-Package RestSharp
Install-Package Newtonsoft.Json
Install-Package JsonSubTypes
```

NOTE: RestSharp versions greater than 105.1.0 have a bug which causes file uploads to fail. See [RestSharp#742](https://github.com/restsharp/RestSharp/issues/742)

<a name="installation"></a>
## Installation
Generate the DLL using your preferred tool (e.g. `dotnet build`)

Then include the DLL (under the `bin` folder) in the C# project, and use the namespaces:
```csharp
using IO.FeatureHub.SSE.Api;
using IO.FeatureHub.SSE.Client;
using IO.FeatureHub.SSE.Model;
```
<a name="getting-started"></a>
## Getting Started

```csharp
using System.Collections.Generic;
using System.Diagnostics;
using IO.FeatureHub.SSE.Api;
using IO.FeatureHub.SSE.Client;
using IO.FeatureHub.SSE.Model;

namespace Example
{
    public class Example
    {
        public static void Main()
        {

            Configuration config = new Configuration();
            config.BasePath = "http://localhost";
            var apiInstance = new FeatureServiceApi(config);
            var sdkUrl = sdkUrl_example;  // string | The SDK key for the environment and service account
            var featureKey = featureKey_example;  // string | The key you wish to update/action
            var featureStateUpdate = new FeatureStateUpdate(); // FeatureStateUpdate |  (optional) 

            try
            {
                object result = apiInstance.SetFeatureState(sdkUrl, featureKey, featureStateUpdate);
                Debug.WriteLine(result);
            }
            catch (ApiException e)
            {
                Debug.Print("Exception when calling FeatureServiceApi.SetFeatureState: " + e.Message );
                Debug.Print("Status Code: "+ e.ErrorCode);
                Debug.Print(e.StackTrace);
            }

        }
    }
}
```

<a name="documentation-for-api-endpoints"></a>
## Documentation for API Endpoints

All URIs are relative to *http://localhost*

Class | Method | HTTP request | Description
------------ | ------------- | ------------- | -------------
*FeatureServiceApi* | [**SetFeatureState**](docs/FeatureServiceApi.md#setfeaturestate) | **PUT** /features/{sdkUrl}/{featureKey} | 


<a name="documentation-for-models"></a>

